<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Swim Pulse Performance</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0a1d37">
  <link rel="icon" href="icon-192.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background: #f0f7ff; margin:0; text-align:center; padding:20px; }
    #login { margin-top:50px; }
    input, button { padding:15px; font-size:1.2em; margin:10px; width:90%; max-width:400px; border-radius:12px; border:none; }
    button { background:#0066ff; color:white; font-weight:bold; }
    .card { background:white; margin:20px auto; padding:25px; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.1); max-width:500px; }
    h1 { color:#0a1d37; }
    #app { display:none; }
  </style>
</head>
<body>

<div id="login">
  <h1>Swim Pulse Performance</h1>
  <p>Type your name to continue</p>
  <input type="text" id="name" placeholder="Korra or Ethan" autocomplete="off">
  <button onclick="login()">Enter</button>
</div>

<div id="app">
  <h1>Welcome back, <span id="displayName"></span>!</h1>
  <div class="card"><h2>Today's Workout</h2><p id="workout">Loading...</p></div>
  <div class="card"><h2>Current Goal</h2><p id="goal">Loading...</p></div>
  <div class="card"><h2>Latest Stroke Note</h2><p id="note">Loading...</p></div>
  <div class="card"><h2>Personal Bests</h2><div id="pbs">Loading...</div></div>
</div>

<script>
// === PUT YOUR FIREBASE CONFIG HERE (copy from your Firebase project) ===
const firebaseConfig = {
  apiKey: "AIzaSy*************************************************",
  authDomain: "swimpulse-korra-ethan.firebaseapp.com",
  projectId: "swimpulse-korra-ethan",
  storageBucket: "swimpulse-korra-ethan.appspot.com",
  messagingSenderId: "123456789012",
  appId: "1:123456789012:web:abcdef1234567890"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

function login() {
  const name = document.getElementById('name').value.trim();
  if (!name) return alert("Please enter your name");
  
  localStorage.setItem('swimmer', name.toLowerCase());
  document.getElementById('login').style.display = 'none';
  document.getElementById('app').style.display = 'block';
  document.getElementById('displayName').textContent = name;
  
  db.collection("swimmers").doc(name.toLowerCase()).get()
    .then(doc => {
      if (doc.exists) {
        const d = doc.data();
        document.getElementById('workout').innerHTML = d.todayWorkout || "Rest day";
        document.getElementById('goal').textContent = d.goal || "No goal set";
        document.getElementById('note').textContent = d.strokeNote || "No new notes";
        const pbs = d.pbs || {};
        document.getElementById('pbs').innerHTML = Object.entries(pbs)
          .map(([event, time]) => `<strong>${event}:</strong> ${time}`).join('<br>');
      } else {
        document.getElementById('workout').textContent = "Welcome! Coach will add your plan soon.";
      }
    });
}

// Auto-login if they return
if (localStorage.getItem('swimmer')) {
  document.getElementById('name').value = localStorage.getItem('swimmer');
  login();
}
</script>
</body>
</html>
